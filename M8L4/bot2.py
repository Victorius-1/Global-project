import telebot
from telebot import types
from config import token

bot = telebot.TeleBot(token)
score = 0
current_question = 0  # Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ (0 - Ð½Ð°Ñ‡Ð°Ð»Ð¾, 1-5 - Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹, 6 - Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ)

questions = [
    {
        'text': "Ð’Ð¾Ð¿Ñ€Ð¾Ñ â„–1. Ð§Ñ‚Ð¾ Ð¸ÑÑ‡ÐµÐ·Ð½ÐµÑ‚ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ Ð¸Ð·-Ð·Ð° Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ñ, Ð»ÐµÐ´Ð½Ð¸ÐºÐ¸ Ð¸Ð»Ð¸ ÐºÐ¾Ñ€Ð°Ð»Ð»Ñ‹?â„ï¸ðŸ”¥",
        'options': ["Ð›ÐµÐ´Ð½Ð¸ÐºÐ¸", "ÐšÐ¾Ñ€Ð°Ð»Ð»Ñ‹"],
        'correct': "ÐšÐ¾Ñ€Ð°Ð»Ð»Ñ‹",
        'explanation': """ÐšÐ¾Ñ€Ð°Ð»Ð»Ñ‹ Ð¸ÑÑ‡ÐµÐ·Ð½ÑƒÑ‚ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ.
ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ?
Ð›ÐµÐ´Ð½Ð¸ÐºÐ¸ Ñ‚Ð°ÑŽÑ‚ Ð¿Ð¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾ (Ñ…Ð¾Ñ‚Ñ Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ â€” Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð“Ñ€ÐµÐ½Ð»Ð°Ð½Ð´Ð¸Ñ Ñ‚ÐµÑ€ÑÐµÑ‚ 267 Ð¼Ð»Ñ€Ð´ Ñ‚Ð¾Ð½Ð½ Ð»ÑŒÐ´Ð° Ð² Ð³Ð¾Ð´).
ÐšÐ¾Ñ€Ð°Ð»Ð»Ñ‹ Ð³Ð¸Ð±Ð½ÑƒÑ‚ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ð¾ Ð¸Ð·-Ð·Ð° Ð¾ÐºÐ¸ÑÐ»ÐµÐ½Ð¸Ñ Ð¾ÐºÐµÐ°Ð½Ð° Ð¸ Ð¿Ð¾Ð²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹ Ð²Ð¾Ð´Ñ‹. Ð£Ð¶Ðµ Ðº 2050 Ð³Ð¾Ð´Ñƒ 90% Ñ€Ð¸Ñ„Ð¾Ð² Ð¼Ð¾Ð³ÑƒÑ‚ Ð¿Ð¾Ð³Ð¸Ð±Ð½ÑƒÑ‚ÑŒ (WWF).
ÐÑŽÐ°Ð½Ñ: Ð¢Ð°ÑÐ½Ð¸Ðµ Ð»ÐµÐ´Ð½Ð¸ÐºÐ¾Ð² Ð¿Ð¾Ð´Ð½Ð¸Ð¼ÐµÑ‚ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð¾ÐºÐµÐ°Ð½Ð°, Ð½Ð¾ ÐºÐ¾Ñ€Ð°Ð»Ð»Ñ‹ â€” ÑÑ‚Ð¾ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹, Ð¾Ñ‚ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð·Ð°Ð²Ð¸ÑÑÑ‚ 25% Ð¼Ð¾Ñ€ÑÐºÐ¸Ñ… Ð²Ð¸Ð´Ð¾Ð²."""
    },
    {
        'text': "Ð’Ð¾Ð¿Ñ€Ð¾Ñ â„–2. Ð§Ñ‚Ð¾ ÑÐ¸Ð»ÑŒÐ½ÐµÐµ Ð²Ñ€ÐµÐ´Ð¸Ñ‚ ÐºÐ»Ð¸Ð¼Ð°Ñ‚Ñƒ Ð·Ð° 1 Ð¿Ð¾ÐµÐ·Ð´ÐºÑƒ, Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ Ð¸Ð»Ð¸ ÑÐ°Ð¼Ð¾Ð»ÐµÑ‚?ðŸš—âœˆï¸",
        'options': ["ðŸš— ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ", "âœˆï¸ Ð¡Ð°Ð¼Ð¾Ð»ÐµÑ‚"],
        'correct': "âœˆï¸ Ð¡Ð°Ð¼Ð¾Ð»ÐµÑ‚",
        'explanation': """Ð¡Ð°Ð¼Ð¾Ð»Ñ‘Ñ‚ Ð²Ñ€ÐµÐ´Ð½ÐµÐµ Ð½Ð° Ð´Ð°Ð»ÑŒÐ½Ð¸Ñ… Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑÑ….
Ð¦Ð¸Ñ„Ñ€Ñ‹:
ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ (Ð±ÐµÐ½Ð·Ð¸Ð½): ~0.2 ÐºÐ³ COâ‚‚ Ð½Ð° ÐºÐ¼.
Ð¡Ð°Ð¼Ð¾Ð»Ñ‘Ñ‚: ~0.25 ÐºÐ³ COâ‚‚ Ð½Ð° ÐºÐ¼ Ð¿Ð°ÑÑÐ°Ð¶Ð¸Ñ€Ð°, Ð½Ð¾ Ñ€ÐµÐ¹Ñ ÐœÐ¾ÑÐºÐ²Ð°â€“Ð‘Ð°Ð½Ð³ÐºÐ¾Ðº (~7 000 ÐºÐ¼) = 1.75 Ñ‚Ð¾Ð½Ð½Ñ‹ COâ‚‚ (ÐºÐ°Ðº Ð³Ð¾Ð´ Ð²Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð°Ð²Ñ‚Ð¾).
ÐÑŽÐ°Ð½Ñ: Ð•ÑÐ»Ð¸ ÐµÑ…Ð°Ñ‚ÑŒ Ð½Ð° Ð°Ð²Ñ‚Ð¾ Ð² Ð¾Ð´Ð¸Ð½Ð¾Ñ‡ÐºÑƒ, ÑÐ°Ð¼Ð¾Ð»Ñ‘Ñ‚ Ð²Ñ‹Ð³Ð¾Ð´Ð½ÐµÐµ. ÐÐ¾ Ñ Ð¿Ð°ÑÑÐ°Ð¶Ð¸Ñ€Ð°Ð¼Ð¸ Ð°Ð²Ñ‚Ð¾ ÑÐºÐ¾Ð»Ð¾Ð³Ð¸Ñ‡Ð½ÐµÐµ"""
    },
    {
        'text': 'Ð’Ð¾Ð¿Ñ€Ð¾Ñ â„–3. Ð§Ñ‚Ð¾ "Ð²Ð¾Ð´Ð¾Ñ‘Ð¼Ñ‡Ðµ" Ð¸ Ð²Ñ€ÐµÐ´Ð½ÐµÐµ Ð´Ð»Ñ ÑÐºÐ¾Ð»Ð¾Ð³Ð¸Ð¸, Ð³Ð¾Ð²ÑÐ´Ð¸Ð½Ð° Ð¸Ð»Ð¸ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾?ðŸ¥©ðŸŒ±',
        'options': ["ðŸŒ± ÐÐ²Ð¾ÐºÐ°Ð´Ð¾", "ðŸ¥© Ð“Ð¾Ð²ÑÐ´Ð¸Ð½Ð°"],
        'correct': "ðŸ¥© Ð“Ð¾Ð²ÑÐ´Ð¸Ð½Ð°",
        'explanation': """Ð“Ð¾Ð²ÑÐ´Ð¸Ð½Ð° â€” Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ Â«Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Â» Ð¿Ð¾ Ð²Ñ€ÐµÐ´Ñƒ.
Ð”Ð°Ð½Ð½Ñ‹Ðµ:
1 ÐºÐ³ Ð³Ð¾Ð²ÑÐ´Ð¸Ð½Ñ‹ = 15 000 Ð»Ð¸Ñ‚Ñ€Ð¾Ð² Ð²Ð¾Ð´Ñ‹ + 27 ÐºÐ³ COâ‚‚ (ÐºÐ°Ðº 160 ÐºÐ¼ Ð½Ð° Ð°Ð²Ñ‚Ð¾).
1 ÐºÐ³ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ = 2 000 Ð»Ð¸Ñ‚Ñ€Ð¾Ð² Ð²Ð¾Ð´Ñ‹, Ð½Ð¾ Ð¸Ð·-Ð·Ð° ÑÐ¿Ñ€Ð¾ÑÐ° Ð²Ñ‹Ñ€ÑƒÐ±Ð°ÑŽÑ‚ Ð»ÐµÑÐ° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð² ÐœÐµÐºÑÐ¸ÐºÐµ).
ÐÑŽÐ°Ð½Ñ: ÐÐ²Ð¾ÐºÐ°Ð´Ð¾ â€” Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°, Ð° Ð¼ÑÑÐ½Ð°Ñ Ð¸Ð½Ð´ÑƒÑÑ‚Ñ€Ð¸Ñ Ð´Ð°Ñ‘Ñ‚ 14.5% Ð²ÑÐµÑ… Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð²."""
    },
    {
        'text': 'Ð’Ð¾Ð¿Ñ€Ð¾Ñ â„–4. Ð§Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð±Ñ‹ Ñ…ÑƒÐ¶Ðµ Ð´Ð»Ñ Ñ‡ÐµÐ»Ð¾Ð²ÐµÑ‡ÐµÑÑ‚Ð²Ð°, Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ñ…Ð¾Ð»Ð¾Ð´Ð°Ð½Ð¸Ðµ?ðŸŒâ„ï¸',
        'options': ["â„ï¸ Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ñ…Ð¾Ð»Ð¾Ð´Ð°Ð½Ð¸Ðµ", "ðŸ”¥ Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ"],
        'correct': "ðŸ”¥ Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ",
        'explanation': """ÐŸÐ¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð¿Ð°ÑÐ½ÐµÐµ Ð´Ð»Ñ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ñ†Ð¸Ð²Ð¸Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸.
ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ?
ÐŸÐ¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ðµ: Ð­ÐºÑÑ‚Ñ€ÐµÐ¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑˆÑ‚Ð¾Ñ€Ð¼Ñ‹, Ð·Ð°ÑÑƒÑ…Ð¸, Ð¼Ð°ÑÑÐ¾Ð²Ñ‹Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸. Ð£Ð¶Ðµ ÑÐµÐ¹Ñ‡Ð°Ñ ÑƒÑ‰ÐµÑ€Ð± â€” $210 Ð¼Ð»Ñ€Ð´ Ð² Ð³Ð¾Ð´ (NASA).
ÐŸÐ¾Ñ…Ð¾Ð»Ð¾Ð´Ð°Ð½Ð¸Ðµ: Ð—Ð°Ð¼Ð¾Ñ€Ð¾Ð·ÐºÐ¸, Ð½ÐµÑƒÑ€Ð¾Ð¶Ð°Ð¸, Ð½Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÑ‡ÐµÑÑ‚Ð²Ð¾ Ð¿ÐµÑ€ÐµÐ¶Ð¸Ð»Ð¾ Ð¼Ð°Ð»Ñ‹Ð¹ Ð»ÐµÐ´Ð½Ð¸ÐºÐ¾Ð²Ñ‹Ð¹ Ð¿ÐµÑ€Ð¸Ð¾Ð´ (XIVâ€“XIX Ð²ÐµÐºÐ°).
ÐÑŽÐ°Ð½Ñ: Ð ÐµÐ·ÐºÐ¾Ðµ Ð¿Ð¾Ñ…Ð¾Ð»Ð¾Ð´Ð°Ð½Ð¸Ðµ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¸Ð·-Ð·Ð° Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð“Ð¾Ð»ÑŒÑ„ÑÑ‚Ñ€Ð¸Ð¼Ð°) â€” Ñ‚Ð¾Ð¶Ðµ ÐºÐ°Ñ‚Ð°ÑÑ‚Ñ€Ð¾Ñ„Ð°, Ð½Ð¾ Ð¼ÐµÐ½ÐµÐµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾."""
    },
    {
        'text': 'Ð’Ð¾Ð¿Ñ€Ð¾Ñ â„–5. ÐšÑ‚Ð¾ Ð³Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ð²Ñ€Ð°Ð³ ÐºÐ»Ð¸Ð¼Ð°Ñ‚Ð°, Ð·Ð°Ð²Ð¾Ð´Ñ‹ Ð¸Ð»Ð¸ ÐºÐ¾Ñ€Ð¾Ð²Ñ‹?ðŸ­ðŸŒ³',
        'options': ["ðŸ„ ÐšÐ¾Ñ€Ð¾Ð²Ñ‹", "ðŸ­ Ð—Ð°Ð²Ð¾Ð´Ñ‹"],
        'correct': "ðŸ­ Ð—Ð°Ð²Ð¾Ð´Ñ‹",
        'explanation': """Ð—Ð°Ð²Ð¾Ð´Ñ‹ â€” Ð½Ð¾ ÐºÐ¾Ñ€Ð¾Ð²Ñ‹ Ð±Ð»Ð¸Ð·ÐºÐ¾.
Ð¦Ð¸Ñ„Ñ€Ñ‹:
ÐŸÑ€Ð¾Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¸ ÑÐ½ÐµÑ€Ð³ÐµÑ‚Ð¸ÐºÐ°: 30% Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð² COâ‚‚.
Ð–Ð¸Ð²Ð¾Ñ‚Ð½Ð¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾: 14% Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð² (Ð¼ÐµÑ‚Ð°Ð½ Ð¾Ñ‚ ÐºÐ¾Ñ€Ð¾Ð² Ð² 25 Ñ€Ð°Ð· Ð²Ñ€ÐµÐ´Ð½ÐµÐµ COâ‚‚).
ÐÑŽÐ°Ð½Ñ: Ð—Ð°Ð²Ð¾Ð´Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ decarbonize (Ð·ÐµÐ»Ñ‘Ð½Ð°Ñ ÑÐ½ÐµÑ€Ð³Ð¸Ñ), Ð° ÐºÐ¾Ñ€Ð¾Ð² â€” Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾ÐºÑ€Ð°Ñ‚Ð¸Ñ‚ÑŒ."""
    }
]

@bot.message_handler(commands=['start'])
def start(message):
    global score, current_question
    score = 0
    current_question = 0
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton("Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ñƒ")
    markup.add(btn1)
    bot.send_message(message.chat.id, 
                   text=f'ÐŸÑ€Ð¸Ð²ÐµÑ‚, {message.from_user.first_name}! Ð¢ÑƒÑ‚ Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¿Ñ€Ð¾Ð¹Ñ‚Ð¸ Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ñƒ Ð½Ð° Ñ‚ÐµÐ¼Ñƒ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚ÐµÐ¿Ð»ÐµÐ½Ð¸Ñ.',
                   reply_markup=markup)

@bot.message_handler(content_types=['text'])
def handle_text(message):
    global score, current_question
    
    if message.text == "Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ñƒ" and current_question == 0:
        score = 0
        current_question = 1
        ask_question(message)
    
    elif current_question > 0 and current_question <= 5:
        if message.text in questions[current_question-1]['options']:
            check_answer(message)
        elif message.text == "ðŸ“– Ð£Ð·Ð½Ð°Ñ‚ÑŒ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾ÑÑ‚Ð¸":
            show_explanation(message)
        elif message.text == "ðŸ’¨ Ð”Ð°Ð»ÐµÐµ":
            current_question += 1
            if current_question <= 5:
                ask_question(message)
            else:
                show_results(message)

def ask_question(message):
    question = questions[current_question-1]
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    for option in question['options']:
        markup.add(types.KeyboardButton(option))
    bot.send_message(message.chat.id, question['text'], reply_markup=markup)

def check_answer(message):
    global score
    question = questions[current_question-1]
    is_correct = message.text == question['correct']
    
    if is_correct:
        score += 1
    
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add(types.KeyboardButton("ðŸ’¨ Ð”Ð°Ð»ÐµÐµ"), types.KeyboardButton("ðŸ“– Ð£Ð·Ð½Ð°Ñ‚ÑŒ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾ÑÑ‚Ð¸"))
    
    reply_text = "ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾! âœ…" if is_correct else "ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾! âŒ"
    bot.send_message(message.chat.id, reply_text, reply_markup=markup)

def show_explanation(message):
    question = questions[current_question-1]
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add(types.KeyboardButton("ðŸ’¨ Ð”Ð°Ð»ÐµÐµ"))
    bot.send_message(message.chat.id, question['explanation'], reply_markup=markup)

def show_results(message):
    global current_question
    current_question = 0
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add(types.KeyboardButton("Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ñƒ"))
    bot.send_message(message.chat.id, 
                   f'ÐœÐ¾Ð»Ð¾Ð´ÐµÑ†! Ð¢Ñ‹ Ð¿Ñ€Ð¾ÑˆÐµÐ» Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ñƒ Ð½Ð° {score} Ð¸Ð· 5.\n\nÐ¥Ð¾Ñ‡ÐµÑˆÑŒ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ñ‚ÑŒ ÐµÑ‰Ðµ Ñ€Ð°Ð·?',
                   reply_markup=markup)

bot.polling(none_stop=True)